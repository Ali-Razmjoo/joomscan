#start
dprint("Core Joomla Vulnerability");
open(my $DB,"exploit/db/corevul.txt");
my $vver=substr($ver, index($ver, ' ')+1, 16);
$vver =~ s/ //g;
if ($vver eq "") {
  $vvtf=1;
  $vtmp.="[!] We found the live target, but since the Joomla version was not detected we cannot ensure that it's vulnerable, please test it yourself.\n\n";
} else {
  while( my $row = <$DB>)  {
      chomp $row;
      my $fv=substr($row, 0, index($row, '|'));
      my $fd=substr($row, index($row, '|')+1, 1000);
      my @sbug = split /,/, $fv;
      foreach $bs(@sbug){
          if(($bs =~ m/$vver/i) && (substr($vver, 0, 1) eq substr($bs, 0, 1))){
          $fd =~ s/\$target/$target/g;
              $fd =~ s/\\n/\r\n/g;
              $fd =~ s/\|/\r\n\r\n/g;
              $vtmp.="$fd\n\n";
              $vvtf=1;
              last;
          }
      }
  }
  close $DB;
}

if($vvtf==1){tprint("$vtmp");}else{fprint("Target Joomla core is not vulnerable");}
